tinymce.PluginManager.requireLangPack("dictories"),tinymce.create("tinymce.plugins.Dictories",{init:function(t,e){function n(e){return function(){var n=t.settings.dic_list;"string"==typeof n?tinymce.util.XHR.send({url:n,success:function(t){e(tinymce.util.JSON.parse(t))}}):"function"==typeof n?n(e):e(n)}}function i(t,e,n){function i(t,n){return n=n||[],tinymce.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=i(t.menu):(o.value=t.value,e&&e(o)),n.push(o)}),n}return i(t,n||[])}function o(e){var n,o,c,a={},r=t.selection,u=t.dom,l=[{text:"10",value:10},{text:"30",value:30},{text:"All",value:0}],s=0;(n=r.getNode())&&"DICTORIES"!==n.nodeName&&(n=null),a.value=n?u.getAttrib(n,"type"):"",a.count=n?Number(u.getAttrib(n,"count")):s,e&&(o={name:"type",type:"listbox",label:tinymce.i18n.translate("Link list"),values:i(e),onSelect:function(t){a.type=t.control.value()},value:a.value},c={name:"count",type:"listbox",label:tinymce.i18n.translate("Items"),values:i(l),value:a.count},t.windowManager.open({title:tinymce.i18n.translate("Insert dictories"),data:a,body:[o,c],onSubmit:function(e){function i(){var e={type:a.type?a.type:a.value,count:a.count?a.count:s};t.focus(),n?(u.setAttribs(n,e),t.undoManager.add()):(t.insertContent(u.createHTML("dictories",e)),t.insertContent("&nbsp;")),t.selection.select(n),t.nodeChanged()}a=tinymce.extend(a,e.data),t.undoManager.transact(i)}}))}t.on("preInit",function(e){function n(t){return function(e){for(var n=e.length;n--;)e[n].attr("contenteditable",t?"false":null)}}t.parser.addNodeFilter("dictories",n(!0)),t.serializer.addNodeFilter("dictories",n(!1))}),t.addButton("dictories",{icon:"books",tooltip:tinymce.i18n.translate("Insert/edit dictories"),onclick:n(o),stateSelector:"dictories[type][count]"}),t.addMenuItem("dictories",{text:tinymce.i18n.translate("Dictories"),icon:"books",onclick:n(o),context:"insert",prependToContext:!0})},getInfo:function(){return{longname:"Dictories Plugin",author:"Kelatev,KPep",authorurl:"http://mdoffice.com.ia/",version:"1.0"}}}),tinymce.PluginManager.add("dictories",tinymce.plugins.Dictories);
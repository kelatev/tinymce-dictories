tinymce.PluginManager.add("dictories",function(t){function e(t,e,n){function i(t,n){return n=n||[],tinymce.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=i(t.menu):(o.value=t.value,e&&e(o)),n.push(o)}),n}return i(t,n||[])}t.addButton("dictories",{text:"dic",icon:!1,tooltip:"Insert/edit dictories",onclick:function(e){return function(){var n=t.settings.dic_list;"string"==typeof n?tinymce.util.XHR.send({url:n,success:function(t){e(tinymce.util.JSON.parse(t))}}):"function"==typeof n?n(e):e(n)}}(function(n){var i,o,u,c,a={},l=t.selection,r=t.dom;i=l.getNode(),o=r.getParent(i,"dictories[type]"),a.value=o?r.getAttrib(o,"type"):"",a.count=o?Number(r.getAttrib(o,"count")):0,n&&(u={name:"type",type:"listbox",label:"Link list",values:e(n),onselect:function(t){a.value=t.control.value()},value:a.value,onPostRender:function(){u=this}},c={name:"count",type:"listbox",label:"Items",values:e([{text:"10",value:10},{text:"30",value:30},{text:"All",value:0}]),value:a.count,onPostRender:function(){u=this}},t.windowManager.open({title:"Insert dictories",data:a,body:[u,c],onSubmit:function(e){function n(){var e={value:a.value?a.value:null,count:0!=a.count?a.count:null};o?(t.focus(),onlyText&&a.text!=initialText&&("innerText"in o?o.innerText=a.text:o.textContent=a.text),r.setAttribs(o,e),l.select(o),t.undoManager.add()):t.insertContent(r.createHTML("dictories",e))}a=tinymce.extend(a,e.data),t.undoManager.transact(n)}}))}),stateSelector:"dictories[type]"})});